{% extends 'base.html' %}

{% load static %}

{% block title %} หน้าหลัก {% endblock title%}

{% block content %}

<body class="bg-light">


    <div class="header">
        <h1><i class="fas fa-pills me-2"></i>ตารางกินยาวันนี้</h1>
        <h2>วันที่: {{ current_date|date:"j F Y" }} | เวลา: {{ current_date|time:"H:i" }} น.</h2>
    </div>



    <div class="container">

        {% if reminder_late|length == 0 and reminder_list|length == 0 %}
        <h1 class="mt-3">ไม่มีรายการกินยาในวันนี้</h1>
        {% else %}
        {% for i in reminder_late %}
        {% if i %}
        <div class="med-card card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1 style="color: red;">{{ i.reminder_time }} น.</h1>
                        <h1 style="color: red;">เลยเวลากินแล้ว</h1>
                        <h3>{{ i.prescription.medication.name }}</h3>
                        <h4 class="text-muted mb-2">( {{ i.prescription.duration }} )</h4>
                        <h6 class="" style="color: rgb(207, 0, 0);">หมายเหตุ: {{ i.prescription.notes }}</h6>
                    </div>
                    {% if not i.taken %}
                    <div class="d-flex align-items-center">
                        <a href="{% url 'home' %}?click={{i.id}}" class="btn btn-danger">
                            <h4><i class="fas fa-pills me-2"></i>กินยา</h4>
                        </a>
                    </div>
                    {% else %}
                    <div class="d-flex align-items-center">
                        <h4 style="color: green;"><i class="fas fa-pills me-2"></i>กินยาแล้ว</h4>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}

        {% for r in reminder_list %}
        <div class="med-card card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1>{{ r.reminder_time }} น.</h1>
                        <h3>{{ r.prescription.medication.name }}</h3>
                        <h4 class="text-muted mb-2">( {{ r.prescription.duration }} )</h4>
                        <h6 class="" style="color: rgb(207, 0, 0);">หมายเหตุ: {{ r.prescription.notes }}</h6>
                    </div>
                    {% if not r.taken %}
                    <div class="d-flex align-items-center">
                        <a href="{% url 'home' %}?click={{r.id}}" class="btn btn-danger">
                            <h4><i class="fas fa-pills me-2"></i>กินยา</h4>
                        </a>
                    </div>
                    {% else %}
                    <div class="d-flex align-items-center">
                        <h4 style="color: green;"><i class="fas fa-pills me-2"></i>กินยาแล้ว</h4>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}

        {% if reminder_eaten|length != 0 %}
        {% for re in reminder_eaten %}
        <div class="med-card card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h1>{{ re.reminder_time }} น.</h1>
                        <h3>{{ re.prescription.medication.name }}</h3>
                        <h4 class="text-muted mb-2">( {{ re.prescription.duration }} )</h4>
                        <h6 class="" style="color: rgb(207, 0, 0);">หมายเหตุ: {{ re.prescription.notes }}</h6>
                    </div>
                    {% if re.taken %}
                    <div class="d-flex align-items-center">
                        <h4 style="color: green;"><i class="fas fa-pills me-2"></i>กินยาแล้ว</h4>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}





    </div>
</body>
{% endblock content %}

{% block script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
<script>
    setTimeout(function () {
        location.reload();
    }, 30000); // JavaScript สำหรับรีเฟรช
</script>
{% endblock script %}